#!/usr/bin/env python2 -u
import argparse
import sys
import sldb.common.config as config

if __name__ == '__main__':
    parser = config.get_base_arg_parser(
        'Imports V/J identifications from HighV-Quest output')
    parser.add_argument('summary_file', help='Summary file')
    parser.add_argument('gapped_nt_file', help='Gapped NT file')
    parser.add_argument('v_germlines', help='FASTA file with IMGT gapped '
                        'V-gene germlines')
    parser.add_argument('study_name', help='Name of study')
    parser.add_argument('sample_name', help='Name of sample')
    parser.add_argument('read_type', help='Type of read (R1, R2, or R1+R2)')
    parser.add_argument('subject', help='Subject identifier')
    parser.add_argument('date', help='Date of sample')

    for key in ('subset', 'tissue', 'disease', 'lab',
                'experimenter'):
        parser.add_argument('--{}'.format(key), default=None,
                            help='Metadata for {}'.format(key))

    args = parser.parse_args()

    session = config.init_db(args.master_db_config, args.data_db_config)

    from sldb.importing.high_v_quest import run_high_v_quest_import
    sys.exit(run_high_v_quest_import(session, args))
