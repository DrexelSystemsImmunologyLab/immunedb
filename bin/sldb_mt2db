#!/usr/bin/env python2 -u
import argparse
import sys
import sldb.common.config as config

if __name__ == '__main__':
    parser = config.get_base_arg_parser('Parse master-table into database.')
    parser.add_argument('-c', type=int, default=1000, help='Number of'
                        ' sequences to parse between commits')
    parser.add_argument('mt_dir', help='Master table directory')
    args = parser.parse_args()

    session = config.init_db(args.master_db_config, args.data_db_config)

    from sldb.conversion.mt2db import run_mt2db
    sys.exit(run_mt2db(session, args))
